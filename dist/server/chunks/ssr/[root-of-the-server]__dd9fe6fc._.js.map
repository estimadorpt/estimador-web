{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/bernardo/estimador-web/src/lib/config/colors.ts"],"sourcesContent":["export const partyColors = {\n  \"AD\": \"#FF8C00\",  // Dark Orange\n  \"PS\": \"#E57373\",  // Muted Pink\n  \"CH\": \"#377EB8\",  // Blue\n  \"IL\": \"#A6CEE3\",  // Light Blue \n  \"BE\": \"#000000\",  // Black\n  \"CDU\": \"#E41A1C\", // Red\n  \"L\":  \"#90EE90\",  // Light Green\n  \"PAN\": \"#4CAF50\", // Green for PAN\n  \"OTH\": \"#A65628\"  // Brown\n};\n\nexport const partyOrder = [\"AD\", \"PS\", \"CH\", \"IL\", \"BE\", \"CDU\", \"L\", \"PAN\", \"OTH\"];\n\nexport const partyNames = {\n  \"AD\": \"Aliança Democrática\",\n  \"PS\": \"Partido Socialista\", \n  \"CH\": \"Chega\",\n  \"IL\": \"Iniciativa Liberal\",\n  \"BE\": \"Bloco de Esquerda\",\n  \"CDU\": \"CDU\",\n  \"L\": \"Livre\",\n  \"PAN\": \"PAN\",\n  \"OTH\": \"Others\"\n};"],"names":[],"mappings":";;;;;;;;AAAO,MAAM,cAAc;IACzB,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,OAAO;IACP,KAAM;IACN,OAAO;IACP,OAAO,UAAW,QAAQ;AAC5B;AAEO,MAAM,aAAa;IAAC;IAAM;IAAM;IAAM;IAAM;IAAM;IAAO;IAAK;IAAO;CAAM;AAE3E,MAAM,aAAa;IACxB,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM;IACN,OAAO;IACP,KAAK;IACL,OAAO;IACP,OAAO;AACT","debugId":null}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Users/bernardo/estimador-web/src/components/charts/PollingChart.tsx"],"sourcesContent":["\"use client\";\n\nimport * as Plot from \"@observablehq/plot\";\nimport { useEffect, useRef } from \"react\";\nimport { partyColors } from \"@/lib/config/colors\";\n\ninterface TrendData {\n  date: string;\n  party: string;\n  metric: string;\n  value: number;\n}\n\ninterface PollingChartProps {\n  data: TrendData[];\n}\n\nexport function PollingChart({ data }: PollingChartProps) {\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (!data || data.length === 0 || !containerRef.current) return;\n\n    // Get actual container width for truly responsive sizing\n    const containerWidth = containerRef.current.offsetWidth || 900;\n    const containerHeight = 450; // Good height for the space\n\n    // Filter for vote share data only\n    const voteShareData = data.filter(d => d.metric === 'vote_share_mean');\n    \n    // Filter to recent time period - show all parties\n    const cutoffDate = new Date();\n    cutoffDate.setFullYear(cutoffDate.getFullYear() - 2); // Last 2 years only\n    \n    const filteredData = voteShareData.filter(d => new Date(d.date) >= cutoffDate);\n    \n    // Get latest values for all parties\n    const latestData = filteredData\n      .filter(d => {\n        const maxDate = new Date(Math.max(...filteredData.map(dd => new Date(dd.date).getTime())));\n        return new Date(d.date).getTime() === maxDate.getTime();\n      })\n      .sort((a, b) => b.value - a.value);\n    \n    const plot = Plot.plot({\n      width: containerWidth,\n      height: containerHeight,\n      marginLeft: 60,\n      marginRight: 120, // Space for labels\n      marginTop: 20,\n      marginBottom: 50, // Reasonable space for x-axis labels\n      style: {\n        backgroundColor: \"transparent\",\n        fontSize: \"12px\",\n        fontFamily: \"Inter, system-ui, sans-serif\"\n      },\n      x: {\n        type: \"time\",\n        label: null,\n        tickFormat: \"%b %Y\",\n        grid: true,\n        ticks: 4\n      },\n      y: {\n        label: \"Vote share (%)\",\n        domain: [0, 0.5],\n        tickFormat: d => `${(d * 100).toFixed(0)}%`,\n        grid: true\n      },\n      color: {\n        type: \"categorical\",\n        domain: Object.keys(partyColors),\n        range: Object.values(partyColors)\n      },\n      marks: [\n        // Background grid\n        Plot.gridY({ stroke: \"#f3f4f6\", strokeWidth: 1 }),\n        Plot.gridX({ stroke: \"#f3f4f6\", strokeWidth: 1 }),\n        \n        // Lines for each party\n        Plot.line(filteredData, {\n          x: d => new Date(d.date),\n          y: \"value\",\n          stroke: \"party\",\n          strokeWidth: 2.5,\n          curve: \"catmull-rom\"\n        }),\n        \n        // Points for latest values\n        Plot.dot(latestData, {\n          x: d => new Date(d.date),\n          y: \"value\",\n          fill: \"party\",\n          r: 4,\n          stroke: \"white\",\n          strokeWidth: 2\n        }),\n        \n        // Major parties - label at line end\n        Plot.text(latestData.filter(d => d.value > 0.1), {\n          x: d => new Date(d.date),\n          y: \"value\",\n          text: d => `${d.party} ${(d.value * 100).toFixed(1)}%`,\n          fill: \"party\",\n          dx: 8,\n          fontSize: 11,\n          fontWeight: \"600\",\n          textAnchor: \"start\"\n        }),\n        \n        // Minor parties - sorted bottom to top to match visual order\n        Plot.text(latestData.filter(d => d.value <= 0.1).sort((a, b) => a.value - b.value), Plot.dodgeY({\n          x: d => new Date(d.date),\n          y: \"value\",\n          text: d => `${d.party} ${(d.value * 100).toFixed(1)}%`,\n          fill: \"party\",\n          dx: 8,\n          dy: -3, // Move labels slightly up\n          fontSize: 10,\n          fontWeight: \"500\",\n          textAnchor: \"start\",\n          padding: 4 // Increase spacing between dodged labels\n        }))\n      ]\n    });\n\n    if (containerRef.current) {\n      containerRef.current.replaceChildren(plot);\n    }\n\n    return () => plot.remove();\n  }, [data]);\n\n  // Add resize observer for responsive behavior\n  useEffect(() => {\n    if (!containerRef.current) return;\n    \n    const resizeObserver = new ResizeObserver(() => {\n      // Re-render chart when container size changes\n      if (containerRef.current && data && data.length > 0) {\n        // Small delay to ensure container has final dimensions\n        setTimeout(() => {\n          if (!containerRef.current) return;\n          \n          const containerWidth = containerRef.current.offsetWidth || 900;\n          const containerHeight = 450;\n\n          // Filter for vote share data only\n          const voteShareData = data.filter(d => d.metric === 'vote_share_mean');\n          \n          // Filter to recent time period - show all parties\n          const cutoffDate = new Date();\n          cutoffDate.setFullYear(cutoffDate.getFullYear() - 2);\n          \n          const filteredData = voteShareData.filter(d => new Date(d.date) >= cutoffDate);\n          \n          // Get latest values for all parties\n          const latestData = filteredData\n            .filter(d => {\n              const maxDate = new Date(Math.max(...filteredData.map(dd => new Date(dd.date).getTime())));\n              return new Date(d.date).getTime() === maxDate.getTime();\n            })\n            .sort((a, b) => b.value - a.value);\n          \n          const plot = Plot.plot({\n            width: containerWidth,\n            height: containerHeight,\n            marginLeft: 60,\n            marginRight: 120,\n            marginTop: 20,\n            marginBottom: 50,\n            style: {\n              backgroundColor: \"transparent\",\n              fontSize: \"12px\",\n              fontFamily: \"Inter, system-ui, sans-serif\"\n            },\n            x: {\n              type: \"time\",\n              label: null,\n              tickFormat: \"%b %Y\",\n              grid: true,\n              ticks: 4\n            },\n            y: {\n              label: \"Vote share (%)\",\n              domain: [0, 0.5],\n              tickFormat: d => `${(d * 100).toFixed(0)}%`,\n              grid: true\n            },\n            color: {\n              type: \"categorical\",\n              domain: Object.keys(partyColors),\n              range: Object.values(partyColors)\n            },\n            marks: [\n              Plot.gridY({ stroke: \"#f3f4f6\", strokeWidth: 1 }),\n              Plot.gridX({ stroke: \"#f3f4f6\", strokeWidth: 1 }),\n              \n              Plot.line(filteredData, {\n                x: d => new Date(d.date),\n                y: \"value\",\n                stroke: \"party\",\n                strokeWidth: 2.5,\n                curve: \"catmull-rom\"\n              }),\n              \n              Plot.dot(latestData, {\n                x: d => new Date(d.date),\n                y: \"value\",\n                fill: \"party\",\n                r: 4,\n                stroke: \"white\",\n                strokeWidth: 2\n              }),\n              \n              Plot.text(latestData.filter(d => d.value > 0.1), {\n                x: d => new Date(d.date),\n                y: \"value\",\n                text: d => `${d.party} ${(d.value * 100).toFixed(1)}%`,\n                fill: \"party\",\n                dx: 8,\n                fontSize: 11,\n                fontWeight: \"600\",\n                textAnchor: \"start\"\n              }),\n              \n              Plot.text(latestData.filter(d => d.value <= 0.1).sort((a, b) => a.value - b.value), Plot.dodgeY({\n                x: d => new Date(d.date),\n                y: \"value\",\n                text: d => `${d.party} ${(d.value * 100).toFixed(1)}%`,\n                fill: \"party\",\n                dx: 8,\n                dy: -3,\n                fontSize: 10,\n                fontWeight: \"500\",\n                textAnchor: \"start\",\n                padding: 4\n              }))\n            ]\n          });\n\n          containerRef.current.replaceChildren(plot);\n        }, 100);\n      }\n    });\n    \n    resizeObserver.observe(containerRef.current);\n    \n    return () => resizeObserver.disconnect();\n  }, [data]);\n\n  return (\n    <div className=\"w-full\">\n      <div ref={containerRef} className=\"overflow-x-auto\" />\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 335, "column": 0}, "map": {"version":3,"sources":["file:///Users/bernardo/estimador-web/src/components/charts/SeatChart.tsx"],"sourcesContent":["\"use client\";\n\nimport * as Plot from \"@observablehq/plot\";\nimport { useEffect, useRef } from \"react\";\nimport { partyColors, partyNames } from \"@/lib/config/colors\";\n\ninterface SeatData {\n  party: string;\n  seats: number;\n}\n\ninterface SeatChartProps {\n  data: SeatData[];\n}\n\nexport function SeatChart({ data }: SeatChartProps) {\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (!data || data.length === 0 || !containerRef.current) return;\n\n    // Get actual container width for responsive sizing\n    const containerWidth = containerRef.current.offsetWidth || 1000;\n    const containerHeight = 400;\n\n    // Calculate seat statistics for each party\n    const seatStats = data.reduce((acc, d) => {\n      if (!acc[d.party]) {\n        acc[d.party] = [];\n      }\n      acc[d.party].push(d.seats);\n      return acc;\n    }, {} as Record<string, number[]>);\n\n    const chartData = Object.entries(seatStats).map(([party, seats]) => {\n      const sorted = seats.sort((a, b) => a - b);\n      return {\n        party,\n        mean: Math.round(sorted.reduce((sum, s) => sum + s, 0) / sorted.length),\n        p10: sorted[Math.floor(sorted.length * 0.1)],\n        p25: sorted[Math.floor(sorted.length * 0.25)],\n        p75: sorted[Math.floor(sorted.length * 0.75)],\n        p90: sorted[Math.floor(sorted.length * 0.9)],\n        min: Math.min(...sorted),\n        max: Math.max(...sorted)\n      };\n    }).sort((a, b) => b.mean - a.mean);\n\n    const plot = Plot.plot({\n      width: containerWidth,\n      height: containerHeight,\n      marginLeft: 80,\n      marginRight: 20,\n      marginTop: 20,\n      marginBottom: 40,\n      style: {\n        backgroundColor: \"transparent\",\n        fontSize: \"12px\",\n        fontFamily: \"Inter, system-ui, sans-serif\"\n      },\n      x: {\n        label: \"Projected seats\",\n        grid: true,\n        domain: [0, Math.max(...chartData.map(d => d.max)) + 10]\n      },\n      y: {\n        label: null,\n        domain: chartData.map(d => d.party),\n        tickFormat: d => partyNames[d as keyof typeof partyNames] || d\n      },\n      color: {\n        type: \"categorical\",\n        domain: Object.keys(partyColors),\n        range: Object.values(partyColors)\n      },\n      marks: [\n        // Background grid\n        Plot.gridX({ stroke: \"#f3f4f6\", strokeWidth: 1 }),\n        \n        // Uncertainty bands (80% confidence)\n        Plot.barX(chartData, {\n          x1: \"p10\",\n          x2: \"p90\",\n          y: \"party\",\n          fill: \"party\",\n          fillOpacity: 0.2,\n          height: 20\n        }),\n        \n        // Interquartile range (50% confidence)\n        Plot.barX(chartData, {\n          x1: \"p25\",\n          x2: \"p75\",\n          y: \"party\",\n          fill: \"party\",\n          fillOpacity: 0.4,\n          height: 20\n        }),\n        \n        // Mean projection\n        Plot.dot(chartData, {\n          x: \"mean\",\n          y: \"party\",\n          fill: \"party\",\n          r: 4,\n          stroke: \"white\",\n          strokeWidth: 2\n        }),\n        \n        // Mean labels\n        Plot.text(chartData, {\n          x: \"mean\",\n          y: \"party\",\n          text: \"mean\",\n          dx: 15,\n          fontSize: 11,\n          fontWeight: \"600\",\n          fill: \"#374151\"\n        })\n      ]\n    });\n\n    if (containerRef.current) {\n      containerRef.current.replaceChildren(plot);\n    }\n\n    return () => plot.remove();\n  }, [data]);\n\n  // Add resize observer for responsive behavior\n  useEffect(() => {\n    if (!containerRef.current) return;\n    \n    const resizeObserver = new ResizeObserver(() => {\n      // Re-render chart when container size changes\n      if (containerRef.current && data && data.length > 0) {\n        // Small delay to ensure container has final dimensions\n        setTimeout(() => {\n          if (!containerRef.current) return;\n          \n          const containerWidth = containerRef.current.offsetWidth || 1000;\n          const containerHeight = 400;\n\n          // Calculate seat statistics for each party\n          const seatStats = data.reduce((acc, d) => {\n            if (!acc[d.party]) {\n              acc[d.party] = [];\n            }\n            acc[d.party].push(d.seats);\n            return acc;\n          }, {} as Record<string, number[]>);\n\n          const chartData = Object.entries(seatStats).map(([party, seats]) => {\n            const sorted = seats.sort((a, b) => a - b);\n            return {\n              party,\n              mean: Math.round(sorted.reduce((sum, s) => sum + s, 0) / sorted.length),\n              p10: sorted[Math.floor(sorted.length * 0.1)],\n              p25: sorted[Math.floor(sorted.length * 0.25)],\n              p75: sorted[Math.floor(sorted.length * 0.75)],\n              p90: sorted[Math.floor(sorted.length * 0.9)],\n              min: Math.min(...sorted),\n              max: Math.max(...sorted)\n            };\n          }).sort((a, b) => b.mean - a.mean);\n\n          const plot = Plot.plot({\n            width: containerWidth,\n            height: containerHeight,\n            marginLeft: 80,\n            marginRight: 20,\n            marginTop: 20,\n            marginBottom: 40,\n            style: {\n              backgroundColor: \"transparent\",\n              fontSize: \"12px\",\n              fontFamily: \"Inter, system-ui, sans-serif\"\n            },\n            x: {\n              label: \"Projected seats\",\n              grid: true,\n              domain: [0, Math.max(...chartData.map(d => d.max)) + 10]\n            },\n            y: {\n              label: null,\n              domain: chartData.map(d => d.party),\n              tickFormat: d => partyNames[d as keyof typeof partyNames] || d\n            },\n            color: {\n              type: \"categorical\",\n              domain: Object.keys(partyColors),\n              range: Object.values(partyColors)\n            },\n            marks: [\n              // Background grid\n              Plot.gridX({ stroke: \"#f3f4f6\", strokeWidth: 1 }),\n              \n              // Uncertainty bands (80% confidence)\n              Plot.barX(chartData, {\n                x1: \"p10\",\n                x2: \"p90\",\n                y: \"party\",\n                fill: \"party\",\n                fillOpacity: 0.2,\n                height: 20\n              }),\n              \n              // Interquartile range (50% confidence)\n              Plot.barX(chartData, {\n                x1: \"p25\",\n                x2: \"p75\",\n                y: \"party\",\n                fill: \"party\",\n                fillOpacity: 0.4,\n                height: 20\n              }),\n              \n              // Mean projection\n              Plot.dot(chartData, {\n                x: \"mean\",\n                y: \"party\",\n                fill: \"party\",\n                r: 4,\n                stroke: \"white\",\n                strokeWidth: 2\n              }),\n              \n              // Mean labels\n              Plot.text(chartData, {\n                x: \"mean\",\n                y: \"party\",\n                text: \"mean\",\n                dx: 15,\n                fontSize: 11,\n                fontWeight: \"600\",\n                fill: \"#374151\"\n              })\n            ]\n          });\n\n          containerRef.current.replaceChildren(plot);\n        }, 100);\n      }\n    });\n    \n    resizeObserver.observe(containerRef.current);\n    \n    return () => resizeObserver.disconnect();\n  }, [data]);\n\n  return (\n    <div className=\"w-full\">\n      <div ref={containerRef} className=\"overflow-x-auto\" />\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 599, "column": 0}, "map": {"version":3,"sources":["file:///Users/bernardo/estimador-web/src/components/charts/DistrictSummary.tsx"],"sourcesContent":["\"use client\";\n\nimport { partyColors, partyNames } from \"@/lib/config/colors\";\n\ninterface DistrictForecast {\n  district_name: string;\n  winning_party: string;\n  probs: Record<string, number>;\n}\n\ninterface ContestedData {\n  districts: Record<string, {\n    ENSC: number;\n    delta2024?: Record<string, number>;\n    parties?: Record<string, Record<string, number>>;\n  }>;\n}\n\ninterface DistrictSummaryProps {\n  districtData: DistrictForecast[];\n  contestedData: ContestedData;\n}\n\nexport function DistrictSummary({ districtData, contestedData }: DistrictSummaryProps) {\n  if (!districtData || districtData.length === 0) {\n    return (\n      <div className=\"text-center py-8 text-gray-500\">\n        <p>District analysis loading...</p>\n      </div>\n    );\n  }\n\n  // Sort districts by competitiveness (ENSC score)\n  const sortedDistricts = districtData\n    .map(district => {\n      const contestedInfo = contestedData?.districts?.[district.district_name];\n      const competitiveness = contestedInfo?.ENSC || 0;\n      \n      // Get top 2 parties by probability\n      const parties = Object.entries(district.probs)\n        .sort(([,a], [,b]) => b - a)\n        .slice(0, 2);\n      \n      return {\n        ...district,\n        competitiveness,\n        topParties: parties,\n        isContested: competitiveness > 0.8\n      };\n    })\n    .sort((a, b) => b.competitiveness - a.competitiveness);\n\n  const contestedDistricts = sortedDistricts.filter(d => d.isContested);\n  const safeDistricts = sortedDistricts.filter(d => !d.isContested);\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Contested Districts */}\n      {contestedDistricts.length > 0 && (\n        <div>\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n            Seats in Play ({contestedDistricts.length} districts)\n          </h3>\n          <p className=\"text-sm text-gray-600 mb-4\">\n            Districts where seat allocation is uncertain - small changes in vote share could flip seats between parties.\n          </p>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {contestedDistricts.slice(0, 9).map(district => {\n              const contestedInfo = contestedData?.districts?.[district.district_name];\n              const seatChanges = contestedInfo?.parties || {};\n              \n              // Find parties with meaningful seat change probabilities\n              const partiesWithChanges = Object.entries(seatChanges)\n                .map(([party, probs]) => {\n                  const gainProb = (probs[\"1\"] || 0) + (probs[\"2\"] || 0);\n                  const loseProb = (probs[\"-1\"] || 0) + (probs[\"-2\"] || 0);\n                  return {\n                    party,\n                    gainProb,\n                    loseProb,\n                    hasChange: gainProb > 0.05 || loseProb > 0.05\n                  };\n                })\n                .filter(p => p.hasChange)\n                .sort((a, b) => (b.gainProb + b.loseProb) - (a.gainProb + a.loseProb))\n                .slice(0, 3);\n\n              return (\n                <div key={district.district_name} className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <h4 className=\"font-medium text-gray-900\">{district.district_name}</h4>\n                    <span className=\"text-xs bg-yellow-200 text-yellow-800 px-2 py-1 rounded\">\n                      ENSC: {district.competitiveness.toFixed(2)}\n                    </span>\n                  </div>\n                  <div className=\"space-y-2\">\n                    {partiesWithChanges.length > 0 ? partiesWithChanges.map(({ party, gainProb, loseProb }) => (\n                      <div key={party} className=\"space-y-1\">\n                        <div className=\"flex items-center gap-2\">\n                          <div \n                            className=\"w-3 h-3 rounded\"\n                            style={{ backgroundColor: partyColors[party as keyof typeof partyColors] }}\n                          />\n                          <span className=\"text-sm font-medium\">\n                            {partyNames[party as keyof typeof partyNames] || party}\n                          </span>\n                        </div>\n                        <div className=\"ml-5 text-xs text-gray-600\">\n                          {gainProb > 0.05 && (\n                            <span className=\"text-green-700\">+1 seat: {(gainProb * 100).toFixed(0)}%</span>\n                          )}\n                          {gainProb > 0.05 && loseProb > 0.05 && <span className=\"mx-1\">•</span>}\n                          {loseProb > 0.05 && (\n                            <span className=\"text-red-700\">-1 seat: {(loseProb * 100).toFixed(0)}%</span>\n                          )}\n                        </div>\n                      </div>\n                    )) : (\n                      <div className=\"text-xs text-gray-500\">Close race for seat allocation</div>\n                    )}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      )}\n\n      {/* Safe Districts Summary */}\n      <div>\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\n          Likely Winners by District\n        </h3>\n        <div className=\"bg-white border border-gray-200 rounded-lg p-4\">\n          <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\n            {Object.values(partyColors).map((color, index) => {\n              const party = Object.keys(partyColors)[index];\n              const wins = safeDistricts.filter(d => d.winning_party === party).length;\n              \n              if (wins === 0) return null;\n              \n              return (\n                <div key={party} className=\"text-center\">\n                  <div \n                    className=\"w-12 h-12 mx-auto mb-2 rounded-lg flex items-center justify-center text-white font-bold shadow-md\"\n                    style={{ backgroundColor: color }}\n                  >\n                    {wins}\n                  </div>\n                  <div className=\"text-sm font-medium text-gray-900\">\n                    {partyNames[party as keyof typeof partyNames] || party}\n                  </div>\n                  <div className=\"text-xs text-gray-500\">districts</div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      </div>\n\n      {/* Summary Stats */}\n      <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\n        <div className=\"grid grid-cols-3 gap-4 text-center\">\n          <div>\n            <div className=\"text-2xl font-bold text-gray-900\">{districtData.length}</div>\n            <div className=\"text-sm text-gray-600\">Total districts</div>\n          </div>\n          <div>\n            <div className=\"text-2xl font-bold text-yellow-600\">{contestedDistricts.length}</div>\n            <div className=\"text-sm text-gray-600\">Seats in play</div>\n          </div>\n          <div>\n            <div className=\"text-2xl font-bold text-green-600\">{safeDistricts.length}</div>\n            <div className=\"text-sm text-gray-600\">Stable allocation</div>\n          </div>\n        </div>\n        \n        <div className=\"mt-4 pt-4 border-t border-gray-200\">\n          <p className=\"text-xs text-gray-500\">\n            <strong>ENSC (Effective Number of Seat Changes)</strong> measures seat allocation uncertainty. \n            Districts with ENSC &gt; 0.8 are classified as having \"seats in play\" where small vote share changes \n            could flip seats between parties under the D'Hondt proportional system.\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1017, "column": 0}, "map": {"version":3,"sources":["file:///Users/bernardo/estimador-web/src/components/charts/HouseEffects.tsx"],"sourcesContent":["\"use client\";\n\nimport { partyColors } from \"@/lib/config/colors\";\n\ninterface HouseEffect {\n  pollster: string;\n  party: string;\n  effect: number;\n  n_polls: number;\n}\n\ninterface HouseEffectsProps {\n  data: HouseEffect[];\n}\n\n// Color interpolation for the heatmap\nfunction getHeatmapColor(value: number): string {\n  // Normalize value to [-1, 1] for color mapping\n  const normalized = Math.max(-1, Math.min(1, value / 0.4));\n  \n  if (Math.abs(normalized) < 0.05) return \"#f8f9fa\";\n  \n  if (normalized > 0) {\n    // Softer red tones for positive values\n    const intensity = Math.abs(normalized);\n    const r = Math.round(254 + (220 - 254) * intensity);\n    const g = Math.round(226 + (38 - 226) * intensity);\n    const b = Math.round(226 + (38 - 226) * intensity);\n    return `rgb(${r}, ${g}, ${b})`;\n  } else {\n    // Softer blue tones for negative values\n    const intensity = Math.abs(normalized);\n    const r = Math.round(219 + (69 - 219) * intensity);\n    const g = Math.round(234 + (123 - 234) * intensity);\n    const b = Math.round(254 + (157 - 254) * intensity);\n    return `rgb(${r}, ${g}, ${b})`;\n  }\n}\n\nexport function HouseEffects({ data }: HouseEffectsProps) {\n  if (!data || data.length === 0) {\n    return (\n      <div className=\"text-center py-8 text-gray-500\">\n        <p>House effects analysis loading...</p>\n      </div>\n    );\n  }\n\n  // Transform data format if needed\n  const transformedData = data.map(d => ({\n    pollster: d.pollster,\n    party: d.party,\n    effect: (d as any).house_effect || d.effect || 0,\n    n_polls: d.n_polls || 5\n  }));\n\n  // Get unique pollsters and parties\n  const pollsters = Array.from(new Set(transformedData.map(d => d.pollster))).sort();\n  const parties = Object.keys(partyColors).filter(party => \n    transformedData.some(d => d.party === party)\n  );\n\n  // Create a matrix for easy lookup\n  const matrix: Record<string, Record<string, number>> = {};\n  transformedData.forEach(d => {\n    if (!matrix[d.pollster]) matrix[d.pollster] = {};\n    matrix[d.pollster][d.party] = d.effect;\n  });\n\n  return (\n    <div className=\"w-full\">\n      <div className=\"bg-white border border-gray-200 rounded-lg overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-4 py-3 text-left text-sm font-semibold text-gray-700 w-40\">\n                  Pollster\n                </th>\n                {parties.map(party => (\n                  <th\n                    key={party}\n                    className=\"px-3 py-3 text-center text-sm font-semibold w-20\"\n                    style={{ color: partyColors[party as keyof typeof partyColors] }}\n                  >\n                    {party}\n                  </th>\n                ))}\n              </tr>\n            </thead>\n            <tbody className=\"divide-y divide-gray-200\">\n              {pollsters.map(pollster => (\n                <tr key={pollster}>\n                  <td className=\"px-4 py-3 text-sm font-medium text-gray-900 bg-gray-50\">\n                    {pollster}\n                  </td>\n                  {parties.map(party => {\n                    const effect = matrix[pollster]?.[party] || 0;\n                    const showValue = Math.abs(effect) > 0.02;\n                    \n                    return (\n                      <td\n                        key={`${pollster}-${party}`}\n                        className=\"px-3 py-3 text-center text-xs font-semibold relative group cursor-help\"\n                        style={{ \n                          backgroundColor: getHeatmapColor(effect),\n                          color: Math.abs(effect) > 0.25 ? \"white\" : \"#374151\"\n                        }}\n                        title={`${pollster} → ${party}: ${effect.toFixed(3)} logit`}\n                      >\n                        {showValue && (\n                          <span>\n                            {effect > 0 ? '+' : ''}{effect.toFixed(2)}\n                          </span>\n                        )}\n                        \n                        {/* Tooltip */}\n                        <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10\">\n                          {pollster} → {party}: {effect.toFixed(3)} logit\n                        </div>\n                      </td>\n                    );\n                  })}\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n      \n      <div className=\"mt-4 text-sm text-gray-600 space-y-2\">\n        <p>\n          <strong>House effects</strong> show how each pollster systematically differs from the polling average in logit space. \n          Red cells indicate the pollster tends to show higher support for that party, blue cells show lower support.\n        </p>\n        <p className=\"text-xs\">\n          Values are logit deviations. Larger absolute values indicate stronger systematic bias. Hover over cells for exact values.\n        </p>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1250, "column": 0}, "map": {"version":3,"sources":["file:///Users/bernardo/estimador-web/src/lib/config/blocs.ts"],"sourcesContent":["export const leftBlocParties = [\"PS\", \"BE\", \"CDU\", \"L\"];\nexport const rightBlocParties = [\"AD\", \"IL\"];\nexport const majorityThreshold = 116;\n\nexport const rightPlusParties = [\"AD\", \"IL\"];\nexport const leftPlusScenarioParties = [\"PS\", \"L\", \"PAN\", \"BE\", \"CDU\"];"],"names":[],"mappings":";;;;;;;;;;;;AAAO,MAAM,kBAAkB;IAAC;IAAM;IAAM;IAAO;CAAI;AAChD,MAAM,mBAAmB;IAAC;IAAM;CAAK;AACrC,MAAM,oBAAoB;AAE1B,MAAM,mBAAmB;IAAC;IAAM;CAAK;AACrC,MAAM,0BAA0B;IAAC;IAAM;IAAK;IAAO;IAAM;CAAM","debugId":null}},
    {"offset": {"line": 1288, "column": 0}, "map": {"version":3,"sources":["file:///Users/bernardo/estimador-web/src/components/charts/CoalitionDotPlot.tsx"],"sourcesContent":["\"use client\";\n\nimport * as Plot from \"@observablehq/plot\";\nimport * as d3 from \"d3\";\nimport { useEffect, useRef } from \"react\";\nimport { leftBlocParties, rightBlocParties, majorityThreshold } from \"@/lib/config/blocs\";\n\ninterface SeatData {\n  [party: string]: number;\n}\n\ninterface CoalitionDotPlotProps {\n  data: SeatData[];\n}\n\nexport function CoalitionDotPlot({ data }: CoalitionDotPlotProps) {\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (!data || data.length === 0 || !containerRef.current) {\n      console.log(\"CoalitionDotPlot: No data available\");\n      return;\n    }\n    \n    // Get actual container width for responsive sizing\n    const containerWidth = containerRef.current.offsetWidth || 1000;\n    const containerHeight = 350;\n    \n    console.log(`CoalitionDotPlot: Processing ${data.length} data points, container width: ${containerWidth}`);\n    console.log('First 3 data points:', data.slice(0, 3));\n\n    // Calculate coalition seats for each simulation\n    const blocDrawData = data.flatMap((simulation, index) => {\n      const leftSeats = leftBlocParties.reduce((sum, party) => sum + (simulation[party] || 0), 0);\n      const rightSeats = rightBlocParties.reduce((sum, party) => sum + (simulation[party] || 0), 0);\n      \n      return [\n        { draw: index, bloc: \"Left coalition\", totalSeats: leftSeats },\n        { draw: index, bloc: \"Right coalition\", totalSeats: rightSeats }\n      ];\n    });\n\n    // Calculate medians\n    const blocMedians = Array.from(\n      d3.rollup(blocDrawData, v => d3.median(v, d => d.totalSeats), d => d.bloc),\n      ([bloc, medianSeats]) => ({ bloc, medianSeats })\n    );\n\n    // Sample data for performance - increase for better density\n    const sampleSize = Math.min(1600, blocDrawData.length);\n    const sampledData = d3.shuffle(blocDrawData.slice()).slice(0, sampleSize);\n    \n    console.log(`CoalitionDotPlot: ${blocDrawData.length} coalition data points, sampling ${sampledData.length}`);\n    console.log('Sample of blocDrawData:', blocDrawData.slice(0, 5));\n    console.log('Sample of sampledData:', sampledData.slice(0, 5));\n    console.log('Bloc medians:', blocMedians);\n\n    const plot = Plot.plot({\n      width: containerWidth,\n      height: containerHeight,\n      marginLeft: 140,\n      marginRight: 60,\n      marginTop: 30,\n      marginBottom: 50,\n      style: {\n        backgroundColor: \"transparent\",\n        fontSize: \"12px\",\n        fontFamily: \"Inter, system-ui, sans-serif\"\n      },\n      x: {\n        label: \"Projected seats\",\n        domain: [40, 140],\n        grid: true,\n        ticks: [50, 75, 100, majorityThreshold, 125]\n      },\n      fy: {\n        domain: [\"Left coalition\", \"Right coalition\"],\n        label: null,\n        axis: \"left\",\n        padding: 0.1\n      },\n      color: {\n        domain: [\"Left coalition\", \"Right coalition\"],\n        range: [\"#10b981\", \"#f59e0b\"]\n      },\n      marks: [\n        // Majority line (spans across facets)\n        Plot.ruleX([majorityThreshold], { \n          stroke: \"#dc2626\", \n          strokeWidth: 2, \n          strokeDasharray: \"4,2\",\n          facet: \"exclude\"\n        }),\n        \n        // Dodged dots with slight horizontal jitter\n        Plot.dotX(sampledData, Plot.dodgeY({\n          x: d => d.totalSeats + (Math.random() - 0.5) * 1.5, // Add small horizontal jitter\n          fy: \"bloc\",\n          fill: \"bloc\",\n          fillOpacity: 0.7,\n          r: 1.2,\n          anchor: \"middle\"\n        })),\n        \n        // Median lines\n        Plot.ruleX(blocMedians, {\n          x: \"medianSeats\",\n          fy: \"bloc\",\n          stroke: \"black\",\n          strokeWidth: 2,\n          strokeDasharray: \"2,2\"\n        }),\n        \n        // Median labels\n        Plot.text(blocMedians, {\n          x: \"medianSeats\",\n          fy: \"bloc\",\n          text: d => Math.round(d.medianSeats).toString(),\n          dy: -8,\n          dx: 5,\n          fontSize: 11,\n          fontWeight: \"bold\",\n          fill: \"black\"\n        }),\n        \n        // Majority label\n        Plot.text([{ x: majorityThreshold, fy: \"Left coalition\" }], {\n          x: \"x\",\n          fy: \"fy\",\n          text: `Majority (${majorityThreshold})`,\n          dx: 5,\n          dy: -10,\n          fontSize: 11,\n          fill: \"#dc2626\",\n          fontWeight: \"600\"\n        })\n      ]\n    });\n\n    if (containerRef.current) {\n      containerRef.current.replaceChildren(plot);\n    }\n\n    return () => plot.remove();\n  }, [data]);\n\n  // Add resize observer for responsive behavior\n  useEffect(() => {\n    if (!containerRef.current) return;\n    \n    const resizeObserver = new ResizeObserver(() => {\n      // Re-render chart when container size changes\n      if (containerRef.current && data && data.length > 0) {\n        // Small delay to ensure container has final dimensions\n        setTimeout(() => {\n          if (!containerRef.current) return;\n          \n          const containerWidth = containerRef.current.offsetWidth || 1000;\n          const containerHeight = 350;\n\n          // Calculate coalition seats for each simulation\n          const blocDrawData = data.flatMap((simulation, index) => {\n            const leftSeats = leftBlocParties.reduce((sum, party) => sum + (simulation[party] || 0), 0);\n            const rightSeats = rightBlocParties.reduce((sum, party) => sum + (simulation[party] || 0), 0);\n            \n            return [\n              { draw: index, bloc: \"Left coalition\", totalSeats: leftSeats },\n              { draw: index, bloc: \"Right coalition\", totalSeats: rightSeats }\n            ];\n          });\n\n          // Calculate medians\n          const blocMedians = Array.from(\n            d3.rollup(blocDrawData, v => d3.median(v, d => d.totalSeats), d => d.bloc),\n            ([bloc, medianSeats]) => ({ bloc, medianSeats })\n          );\n\n          // Sample data for performance\n          const sampleSize = Math.min(1600, blocDrawData.length);\n          const sampledData = d3.shuffle(blocDrawData.slice()).slice(0, sampleSize);\n\n          const plot = Plot.plot({\n            width: containerWidth,\n            height: containerHeight,\n            marginLeft: 140,\n            marginRight: 60,\n            marginTop: 30,\n            marginBottom: 50,\n            style: {\n              backgroundColor: \"transparent\",\n              fontSize: \"12px\",\n              fontFamily: \"Inter, system-ui, sans-serif\"\n            },\n            x: {\n              label: \"Projected seats\",\n              domain: [40, 140],\n              grid: true,\n              ticks: [50, 75, 100, majorityThreshold, 125]\n            },\n            fy: {\n              domain: [\"Left coalition\", \"Right coalition\"],\n              label: null,\n              axis: \"left\",\n              padding: 0.1\n            },\n            color: {\n              domain: [\"Left coalition\", \"Right coalition\"],\n              range: [\"#10b981\", \"#f59e0b\"]\n            },\n            marks: [\n              // Majority line (spans across facets)\n              Plot.ruleX([majorityThreshold], { \n                stroke: \"#dc2626\", \n                strokeWidth: 2, \n                strokeDasharray: \"4,2\",\n                facet: \"exclude\"\n              }),\n              \n              // Dodged dots with slight horizontal jitter\n              Plot.dotX(sampledData, Plot.dodgeY({\n                x: d => d.totalSeats + (Math.random() - 0.5) * 1.5, // Add small horizontal jitter\n                fy: \"bloc\",\n                fill: \"bloc\",\n                fillOpacity: 0.7,\n                r: 1.2,\n                anchor: \"middle\"\n              })),\n              \n              // Median lines\n              Plot.ruleX(blocMedians, {\n                x: \"medianSeats\",\n                fy: \"bloc\",\n                stroke: \"black\",\n                strokeWidth: 2,\n                strokeDasharray: \"2,2\"\n              }),\n              \n              // Median labels\n              Plot.text(blocMedians, {\n                x: \"medianSeats\",\n                fy: \"bloc\",\n                text: d => Math.round(d.medianSeats).toString(),\n                dy: -8,\n                dx: 5,\n                fontSize: 11,\n                fontWeight: \"bold\",\n                fill: \"black\"\n              }),\n              \n              // Majority label\n              Plot.text([{ x: majorityThreshold, fy: \"Left coalition\" }], {\n                x: \"x\",\n                fy: \"fy\",\n                text: `Majority (${majorityThreshold})`,\n                dx: 5,\n                dy: -10,\n                fontSize: 11,\n                fill: \"#dc2626\",\n                fontWeight: \"600\"\n              })\n            ]\n          });\n\n          containerRef.current.replaceChildren(plot);\n        }, 100);\n      }\n    });\n    \n    resizeObserver.observe(containerRef.current);\n    \n    return () => resizeObserver.disconnect();\n  }, [data]);\n\n  if (!data || data.length === 0) {\n    return (\n      <div className=\"w-full h-64 flex items-center justify-center text-gray-500\">\n        <p>Loading coalition data...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"w-full\">\n      <div ref={containerRef} className=\"overflow-x-auto\" />\n      <div className=\"text-xs text-gray-500 mt-2\">\n        Showing {data.length} simulation outcomes\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}